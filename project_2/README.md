# Project 2: Анализ продаж

Стек: SQL, Power BI

Инструменты: SQL Server Management Studio (SSMS)

Проект направлен на автоматизацию анализа данных о продажах для компании Adventure Works Cycles. В его рамках создаются интерактивные дашборды в Power BI, которые предоставляют менеджерам и продавцам ключевые метрики для отслеживания эффективности по товарам, продавцам и выполнения бюджета на основе актуальных данных из CRM.

В качетве БД используется бесплатная тестовая база данных от Microsoft AdventureWorks, разработанная для пользователей SQL Server. База имитирует деятельность вымышленной компании Adventure Works Cycles и включает данные о продажах, производстве и человеческих ресурсах.

Поскольку БД на английском языке, промежуточные таблицы и итоговый дашборд также выполним на языке исходных данных

Результат в формате .pdf можно посмотреть [здесь](https://github.com/annsad9/Projects/tree/main/project_2/result).

### 1. Устанавливаем Power BI и SSMS

Power BI — скачиваем с официального магазина приложений Microsoft Store.

SSMS — скачиваем с официального сайта Microsoft.

### 2. Формулируем цель и задачи

Цель: создать централизованную систему визуализации и анализа данных о продажах для повышения эффективности работы отдела продаж и обеспечения менеджмента актуальной аналитической информацией.

Задачи:

* Интегрировать данные из CRM-системы и бюджетный план.
* Преобразовать и очистить сырые данные с помощью SQL для приведения их к структуре, удобной для анализа.
* Разработать в Power BI интерактивные дашборды для анализа продаж по товарам, продавцам и в разрезе выполнения бюджета.

Пользовательские истории (User Stories):
| № | Роль | Задача | Выполнение | Критерии дашборта в Power BI  |
| - | ---- | ------ | ---------- | -------- |
| 1 | Менеджер по продажам    | Следить за дашбордом                           | Видеть какие товары продаются лучше всего                              | Обновляет данные раз в день            |
| 2 | Продавец(представитель) | Подробный обзор интернет продаж для клиентов   | Можно следить за продавцами, чтобы видеть кто продает больше           | Фильтрует данные по продавцам          |
| 3 | Продавец(представитель) | Подробный обзор интернет продаж для продуктов  | Можно следить за продуктами, чтобы видеть какие продаются лучше        | Фильтрует данные по продуктам          |
| 4 | Менеджер по продажам    | Анализ выполнения плана продаж                 | Следить за динамикой продаж с течением времени и сравнением с бюджетом | Графиками и KPI в сравнении с бюджетом |

### 3. Скачиваем и обновляем БД

Скачиваем хранилище данных AdventureWorks с официального сайта [Microsoft](https://learn.microsoft.com/en-us/sql/samples/adventureworks-install-configure?view=sql-server-ver15&tabs=ssms), 
для восстановления образца базы данных на нашем экземпляре SQL Server следуем инструкциям на сайте.

Также обновим столбцы дат в базе данных используя данный [скрипт SQL](https://github.com/techtalkcorner/SampleDemoFiles/blob/master/Database/AdventureWorks/Update_AdventureWorksDW_Data.sql). Он использует текущий год в качестве последнего года для данных в БД.

Составляем таблицу с бюджетом на год: [FACT_SalesBudget.xlsx](https://github.com/annsad9/Projects/blame/main/project_2/data/FACT_SalesBudget.xlsx)

### 4. Преобразовать данные используя SQL запросы и SSMS

Для создания дашборда необходимо отчистить и преобразовать сырые данные 
Из найденной БД подготовить несколько таблиц используя SQL запросы, на основе которых будет делать визуализацию. 
Для удобства сразу в названии укажет, относится таблица к таблице фактов или измерений.
1. __[DIM_DataCalendar](https://github.com/annsad9/Projects/blob/main/project_2/sql/DimDate_Clear.sql)__ -
преобразуем данные из DIMDate. Оставим только часть данных (за последние 2 года), используя оператор WHERE. Поскольку нужны понятные названия, которые можно использовать при визуализации, переименуем названия столбцов, а также добавим сокращенную версию названия месяца.

2. __[DIM_DateCustomer](https://github.com/annsad9/Projects/blob/main/project_2/sql/DimCustomer_Clear.sql)__ -
преобразуем данные из DimCustomer и DimGeography, объединим таблицы, используя LEFT JOIN. Отсортируем данные по ключу клиента (CustomerKey) и применим оператор CASE для наглядного отображения изменений в столбце Gender.

3. __[DIM_DateProduct](https://github.com/annsad9/Projects/blob/main/project_2/sql/DimProduct_Clear.sql)__ -
Преобразуем данные из DimProduct, DimProductSubcategory, DimProductCategory. Объединим таблицы, используя LEFT JOIN. Отсортируем данные по ключу продукта (ProductKey).
4. __[FACT_InternetSales](https://github.com/annsad9/Projects/blob/main/project_2/sql/FactInternetSales_Clear.sql)__ -
преобразуем данные из FactInternetSales. Отфильтруем данные используя функции GETDATE(), YEAR() и LEFT(), оставляя только данные за последние два полных года относительно текущей даты. Отсортируем данные по дате заказа.

**Для преобразования данных использовались следующие операции:**
1. Оператор AS для переименовывания столбцов
2. Объединение столбцов
3. Комментирование в SQL запросах
4. Оператор WHERE для задания условия для фильтрации данных
5. Оператор ORDER BY для сортировки записей
6. Оппреатор LEFT JOIN для объединения таблиц
7. Оператор CASE для условной логики в запросах
8. Функция ISNULL() для обработки нулевых значений
9. Функция GETDATE() для указания текущей локальной даты
10. Функция YEAR() для извлечения года из текущих данных (в данном случае из GETDATE()).
11. Функция LEFT() для извлечения года из текущих данных (в данном случае из ключа даты заказа OrderDateKey).

### 5. Загрузить полученные данные в Power BI
Импортируем [все данные](https://github.com/annsad9/Projects/tree/main/project_2/data) в Power BI: необходимо проверить корректность определенных типов данных.
![upload_data](https://github.com/annsad9/Projects/blob/main/project_2/image/upload_data.png)

Далее настроим связи между таблицами в модели данных
![model_data](https://github.com/annsad9/Projects/blob/main/project_2/image/model_data.png)
### 6. Создать дашборт на основе полученных данных

На панели визуализации размещаем ключевые показатели (KPI) по общему объему продаж, динамике выручки и выполнению бюджета. 
Для детального анализа добавляем фильтры по периоду (по годам и месяцам), по городам клиентов, категориям, подкатегориям, наименованию и модели товара, а также статусу товара, что позволяет мгновенно сортировать данные. Первая страница включает графики трендов, карту продаж по регионам и таблицу с детализацией по лучшим продавцам и самым продаваемым товарам.
Вторая страница включает таблицу клиентов, график, показывающий продажи по месяцам и полу клиента, продажи по продуктам и городам.

# Результат №1: Category - Bikes, Year - 2024
![2024_Bikes-1](https://github.com/annsad9/Projects/blob/main/project_2/image/2024_Bikes-1.png)
![2024_Bikes-2](https://github.com/annsad9/Projects/blob/main/project_2/image/2024_Bikes-2.png)
# Результат №2: Category - Clothing, Year - 2024
![2024_Clothing-1](https://github.com/annsad9/Projects/blob/main/project_2/image/2024_Clothing-1.png)
![2024_Clothing-2](https://github.com/annsad9/Projects/blob/main/project_2/image/2024_Clothing-2.png)
# Результат №3: Customer City - Paris, Year - 2024
![2024_Paris-1](https://github.com/annsad9/Projects/blob/main/project_2/image/2024_Paris-1.png)
![2024_Paris-2](https://github.com/annsad9/Projects/blob/main/project_2/image/2024_Paris-2.png)

